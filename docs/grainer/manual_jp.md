# Grainer - グラニュラーシンセシス・プロセッサー

VCV Rack向けのリアルタイム・グラニュラーシンセシス・プラグインです。

## 概要

Grainerは、ライブ入力をグレイン単位で分解・再構成するリアルタイム・グラニュラー・プロセッサーです。ピッチ・サイズ・位置・密度を細かく制御しながら、ランダマイズによって有機的なテクスチャを生成します。

最大128ボイス（初期値32）の同時グレイン処理と、5秒バッファに対応し、ライブ演奏からサウンドデザインまで幅広く活用できます。

本モジュールは Max for Live 版 grainer をベースにしています:
https://tsugumasa320.gumroad.com/l/grainer

内蔵リバーブは、Mutable Instruments Cloudsの実装をベースにしています。

## クイックスタート

1. **オーディオ入力**: AUDIO INPUT L/R にソースを接続
2. **グレイン長**: Grain Length を調整 (50ms - 1000ms、デフォルト525ms)
3. **密度**: Density を調整 (表示 0 - 50Hz)
4. **音色調整**: Pitch / Position / Stereo Spread
5. **ミックス**: Dry/Wet と Reverb を調整

## パラメータ

### 基本コントロール

- **Grain Length**: グレイン長 (50ms - 1000ms、デフォルト525ms)
- **Density**: グレイン生成レート (表示 0 - 50Hz)
- **Pitch**: ピッチ比 (1/3x - 3x、中央=1x)
- **Position**: 再生位置 (0-100%: 0%=最古, 100%=REC位置)
- **Stereo Spread**: ステレオ位置のランダマイズ (0-1)
  - **0%**: モノ/センター位置（全グレインがセンターにパン）
  - **50%**: 中程度のステレオスプレッド（センター周り±25%パン範囲）
  - **100%**: 完全なステレオ幅ランダマイズ（グレインがステレオフィールドのどこにでも配置可能）

### 詳細コントロール

- **Pitch Random**: ピッチのランダム量 (0-3)
  - **0**: ピッチランダマイズなし（全グレインが正確なピッチ設定を使用）
  - **1**: ±1オクターブランダム変化 (2^-1 to 2^+1 = 0.5x to 2.0x)
  - **2**: ±2オクターブランダム変化 (2^-2 to 2^+2 = 0.25x to 4.0x)
  - **3**: ±3オクターブランダム変化 (2^-3 to 2^+3 = 0.125x to 8.0x)
- **Pitch Quantize**: ピッチを特定の音高に量子化する度合いを制御 (0-1、デフォルト1.0、ダブルクリックで1.0にリセット)
  - **LED表示**: 現在のピッチが音楽的音程に近い度合いをカラー輝度で表示
  - **動作例**:
    - **Quantize = 0**: 連続的なピッチ変化（量子化なし）
    - **Quantize = 0.5**: ピッチが0.5x, 1.0x, 1.5x, 2.0x...の倍数に吸着
    - **Quantize = 1.0**: 完全に整数比（1.0x, 2.0x, 3.0x...）に固定
  - **用途**: 楽曲的な音程関係を作りたい場合に便利（ハーモニー生成など）
  - **LED輝度**: 有理数計算により、シンプルな音程比（オクターブ、五度など）に近いほど明るく表示
    - 明るいLED = 現在のピッチ値が単純な音楽的比に近い（例：0.5 = 1オクターブ下、0.33 = 5度+オクターブ下）
    - 暗いLED = ピッチ値が音楽的比の間にある
    - 消灯LED = 明確な音楽的比のマッチなし
  - **音楽的動作**:
    - quantize = 0の場合: ピッチが滑らかで連続的に変化
    - quantize = 1の場合: ピッチが離散的なステップでジャンプし、より顕著なピッチ遷移を作成
    - 中間値では滑らかな動作とステップ状動作がブレンド
  - **Window Shape**: Hann窓形状の左右偏り (-1〜+1)
    - **-1**: 左偏りの窓形状
    - **0**: 対称Hann窓（中央位置）
    - **+1**: 右偏りの窓形状
  - **Position Random**: 位置のランダム量 (0-1)
  - **Input Gain**: 入力ゲイン (0-1、リニア)
    - **0%**: 入力信号なし
    - **100%**: フル入力ゲイン
  - **Dry/Wet**: 原音と処理音の比率 (0-1)
    - **0%**: 100%ドライ（原音のみ）
    - **100%**: 100%ウェット（処理音のみ）
  - **Reverb**: 内蔵リバーブ量 (0-1) - Mutable Instruments Cloudsのリバーブ実装をベース
    - **0%**: リバーブなし
    - **100%**: 最大リバーブエフェクト
  - **Forward/Reverse**: 再生方向の切替 (ボタン)
    - **Forward**: 通常再生方向 (デフォルト)
    - **Reverse**: 逆再生方向
  - **Freeze**: バッファのフリーズ (ボタン/CVゲート)
    - **GUI表示**: アクティブ時にボタンが点灯
    - **オフ**: 通常録音モード（バッファが継続的に更新）
    - **オン**: バッファ内容がフリーズ（新しい録音なし、既存内容を保持）

### CV入力
主要パラメータはCV対応（±5Vバイポーラ）:
  - Grain Length CV
  - Density CV
  - Pitch CV（コンテキストメニューで1V/oct切替）
  - Pitch Random CV
  - Position CV
  - Position Random CV
  - Stereo Spread CV
  - Input Gain CV
  - Dry/Wet CV
  - Reverb CV
  - Window Shape CV

## 応用例
  - アンビエントの質感生成
  - リズミックなグラニュラーリピート
  - 実験的なサウンド加工